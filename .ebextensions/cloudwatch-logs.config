Resources:
  CWLogGroup:
    Type: "AWS::Logs::LogGroup"
    Properties:
      LogGroupName: "/aws/elasticbeanstalk/repairfindprod"

files:
  "/etc/awslogs/config/logs.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      [/var/log/nodejs/app.log]
      log_group_name = /aws/elasticbeanstalk/repairfindprod
      log_stream_name = {instance_id}/app.log
      datetime_format = %Y-%m-%d %H:%M:%S

      [/var/log/nodejs/access.log]
      log_group_name = /aws/elasticbeanstalk/repairfindprod
      log_stream_name = {instance_id}/access.log
      datetime_format = %Y-%m-%d %H:%M:%S
      

      [/var/log/nodejs/error.log]
      log_group_name = /aws/elasticbeanstalk/repairfindprod
      log_stream_name = {instance_id}/error.log
      datetime_format = %Y-%m-%d %H:%M:%S

container_commands:
  01_start_awslogs:
    command: "service awslogs start"
  02_enable_awslogs:
    command: "chkconfig awslogs on"
